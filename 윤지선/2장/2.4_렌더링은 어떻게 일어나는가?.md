# 1. 리액트의 렌더링이란?
리액트 애플리케이션 트리 안에 있는 모든 컴포넌트들이 현재 자신들이 가지고 있는 `props`와 `state`의 값을 기반으로 어떻게 UI를 구성하고 이를 바탕으로 어떤 DOM 결과를 브라우저에 제공할 것인지 계산하는 일련의 과정을 의미한다.

<br>

# 2. 리액트의 렌더링이 일어나는 이유
## 최초 렌더링
사용자가 처음 애플리케이션에 진입하면 브라우저에 최초 렌더링이 일어난다.

<br>

## 리렌더링
1. 클래스 컴포넌트의 `setState`가 실행되는 경우
<br>

2. 클래스 컴포넌트의 `forceUpdate`가 실행되는 경우
   - render가 state나 props가 아닌 다른 값에 의존하고 있어 리렌더링을 자동으로 실행할 수 없을 경우 forceUpdate를 실행해 리렌더링을 일으킬 수 있다.
   - <mark>강제 렌더링</mark>이므로 shouldComponentUpdate는 무시하고 건너뛴다. (자신 및 모든 하위 컴포넌트에 적용)
   - render 내에서 사용하면 무한루프에 빠지므로 <mark>render 내에서 사용하면 안 된다.</mark>
<br>

3. 함수 컴포넌트의 `useState()`의 두 번째 배열 요소인 `setter`가 실행되는 경우
<br>

4. 함수 컴포넌트의 `useReducer()`의 두 번째 배열 요소인 `dispatch`가 실행되는 경우
   - useReducer도 useState와 마찬가지로 상태와 이 상태를 업데이트하는 함수를 배열로 제공한다.
<br>

5. 컴포넌트의 `key props`가 변경되는 경우
    - 리액트에서 `key`는 리렌더링이 발생하는 동안 형제 요소들 사이에서 동일한 요소를 식별하는 값이다.
    - key를 사용하면 리렌더링 시 컴포넌트 구별 작업이 최소화되므로 성능 향상에 도움이 된다.
  ```typescript
  const arr = [1, 2, 3]

  export default function App() {
    return (
      <ul>
        {/* 키가 없다면 'Warning: Each child in a list should have a unique "key" props'가 출력된다. */}
        {arr.map((index) => (
          <li key={index}>{index}</li>
        ))}
      </ul>
    )
  }
  ```
<br>

6. `props`가 변경되는 경우
  - 부모로부터 전달받는 props가 달라지면 이를 사용하는 자식 컴포넌트에서도 변경이 필요하므로 리렌더링이 일어난다.
<br>

7. 부모 컴포넌트가 렌더링될 경우

<br>

# 3. 리액트의 렌더링 프로세스
1. 리액트는 컴포넌트의 루트에서부터 차근차근 아래쪽으로 내려가면서 업데이트가 필요한 모든 컴포넌트를 찾는다.


2. 업데이트가 필요한 컴포넌트를 발견하면,
   - 클래스 컴포넌트의 경우에는 클래스 내부의 `render()` 함수를 실행하고
   - 함수 컴포넌트의 경우에는 `FunctionComponent()` 자체를 호출한 뒤에, 그 결과물을 저장한다.


3. 결과물인 JSX 문법을 자바스크립트로 컴파일되면서 `React.createElement()`를 호출하는 구문으로 변환된다.


4. 리액트의 새로운 트리인 가상 DOM과 비교해 실제 DOM에 반영하기 위한 모든 변경 사항을 차례차례 수집한다.

- 이러한 과정을 리액트의 재조정(Reconciliation)이라고 한다.
- 또한, 렌더링은 <mark>렌더 단계</mark>와 <mark>커밋 단계</mark>라는 총 두 단계로 분리되어 실행된다.

<br>

# 4. 렌더와 커밋
#### 렌더 단계(Render Phase)
- 컴포넌트를 렌더링하고 변경 사항을 계산하는 모든 작업을 말한다.
- 크게 `type`, `props`, `key` 세 가지로 비교한다.

#### 커밋 단계(Commit Phase)
- 렌더 단계의 변경 사항을 실제 DOM에 적용해 사용자에게 보여주는 과정을 말한다.
- 이 단계가 끝나야 비로소 브라우저의 렌더링이 일어난다.
- 변경 사항이 없다면, 이 단계는 생략될 수 있다.

  - 즉, <mark>리액트의 렌더링이 일어난다고 해서 무조건 DOM 업데이트가 일어나는 것은 아니다.</mark>
